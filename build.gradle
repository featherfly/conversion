apply from: './gradle/java_base.gradle'  
apply from: './gradle/maven_push.gradle'  

sourceSets {
    main {
        java {
            srcDirs = ["src"]
        }
        resources {
            srcDirs = ["resources"]
        }
    }
    test {
        java {
            srcDirs = ["src-test"]
        }
    }
}

dependencies {
	compile 'cn.featherfly:featherfly-common:1.7.5'
	compile group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: '2.9.9.3'
    testCompile (
    	'org.testng:testng:6.8.21'
    )
}

task("uploadNexusArchives", type: Upload) {
        configuration = configurations.archives
        uploadDescriptor = true
        repositories {
            mavenDeployer {
                beforeDeployment { MavenDeployment deployment -> signing.signPom(deployment) }
                repository(url:"http://192.168.203.241:8081/nexus/content/repositories/releases/") {
                    authentication(userName: 'admin', password: 'admin123')
                }
                pom.project {
                    name project.name
                    packaging 'jar'
                    description 'conversion tool'
                    url 'https://github.com/featherfly/conversion.git'
                    scm {
                        url 'scm:git@github.com:featherfly/conversion.git'
                        connection 'scm:git@github.com:featherfly/conversion.git'
                        developerConnection 'git@github.com:featherfly/conversion.git'
                    }
                    licenses {
                        license {
                            name 'The Apache Software License, Version 2.0'
                            url 'http://www.apache.org/licenses/LICENSE-2.0.txt'
                            distribution 'repo'
                        }
                    }
                    developers {
                        developer {
                            id 'featherfly'
                            name 'zhongji'
                        }
                    }
                }
            }
        }
    } 

